
<script>
    $(document).ready(function () {
        $('#feedback-input').val('');
        $(document).on('click', '.remove-feedback-btn', function () {
            var feedbackID = $(this).siblings('.feedback-text').data('feedback-id');
            var feedbackContainer = $(this).closest('.feedback');
            $.ajax({
                type: 'POST',
                url: '/remove-feedback/' + feedbackID + '/',
                data: {csrfmiddlewaretoken: '{{ csrf_token }}'},
                success: function (response) {
                    feedbackContainer.remove();
                },
            });
        });
    });

</script>

{% if has_case_with_lawyer %}
    <textarea name="feedback" id="feedback-input" placeholder="Add feedback here" maxlength="268"
              style="width: 1000px; height: 100px; vertical-align: top; resize: none" required></textarea><br>
    <br>
    <input type="submit" value="Submit">
{% else %}
    <p>You must be a client of this lawyer to provide feedback.</p>
{% endif %}

<div id="feedback-container">
    {% if feedback %}
        {% for feedback in feedback %}
            <div class="feedback">
                {{ feedback.title }}
                <br>
                {{ feedback.client.name }}
                <br>
                <span class="feedback-text" data-feedback-id="{{ feedback.id }}">{{ feedback.text }}</span>
                {% if client.id == feedback.client.id %}
                    <button class="remove-feedback-btn" type="button">Remove feedback</button>
                {% endif %}
                <br>
            </div>
        {% endfor %}
    {% else %}
        There are no feedbacks yet.<br>
    {% endif %}
</div>
